<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Buchstaben-Wortspiel</title>
<script src="/socket.io/socket.io.js"></script>

<style>
:root {
  --bg:#020617;
  --panel:#111827;
  --accent:#4ade80;
  --danger:#ef4444;
  --text:#e5e7eb;
}
body {
  background: radial-gradient(circle at top, #111827, var(--bg));
  color: var(--text);
  font-family: system-ui, sans-serif;
  margin:0;
}
.container {
  max-width:900px;
  margin:auto;
  padding:40px 20px;
}
.panel {
  background:var(--panel);
  padding:24px;
  border-radius:18px;
  margin-bottom:20px;
}
.center {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
}
input {
  font-size:20px;
  padding:12px;
  border-radius:10px;
  border:none;
  text-align:center;
}
button {
  padding:12px 22px;
  border:none;
  border-radius:10px;
  background:var(--accent);
  cursor:pointer;
  font-weight:600;
}
button.danger { background:var(--danger); color:white; }
button.secondary { background:#374151; color:white; }
.letters {
  display:flex;
  justify-content:center;
  gap:16px;
  margin:30px 0;
}
.letter {
  width:90px;
  height:90px;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:42px;
  background:#020617;
  border-radius:16px;
}
.timer {
  font-size:22px;
  margin-bottom:10px;
}
.players {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:12px;
}
.player {
  background:#020617;
  padding:12px;
  border-radius:12px;
  text-align:center;
}
#submitted {
  color:var(--accent);
  font-size:22px;
}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ§  Buchstaben-Wortspiel</h1>

<div id="lobby" class="panel">
  <div class="center">
    <input id="name" placeholder="Dein Name">
    <div>
      <button onclick="join()">Beitreten</button>
      <button class="secondary" onclick="ready()">Bereit</button>
    </div>
  </div>
  <div class="players" id="players"></div>
</div>

<div id="game" class="panel" style="display:none;">
  <div class="center">
    <div class="timer" id="timer"></div>
    <div class="letters" id="letters"></div>
    <input id="wordInput" placeholder="Wort eingeben & Enter">
    <div id="submitted"></div>

    <div id="voting" style="display:none;">
      <button onclick="vote(true)">ğŸ‘ OK</button>
      <button class="danger" onclick="vote(false)">ğŸ‘ Nicht OK</button>
    </div>

    <button class="secondary" onclick="resetGame()">ğŸ” Reset</button>
  </div>

  <div class="players" id="scores"></div>
</div>

</div>

<script>
const socket = io();
let myId;

socket.on('connect', () => myId = socket.id);

function join() {
  const n = document.getElementById('name').value;
  if (n) socket.emit('join', n);
}
function ready() { socket.emit('ready'); }
function vote(v) { socket.emit('vote', v); }
function resetGame() { socket.emit('reset'); }

document.getElementById('wordInput').addEventListener('keydown', e => {
  if (e.key === 'Enter') {
    socket.emit('submitWord', e.target.value.trim());
  }
});

socket.on('state', game => {
  document.getElementById('lobby').style.display =
    game.phase === 'LOBBY' ? 'block' : 'none';
  document.getElementById('game').style.display =
    game.phase === 'LOBBY' ? 'none' : 'block';

  document.getElementById('timer').textContent =
    game.phase === 'PLAYING' ? `â±ï¸ ${game.timeLeft}s` : '';

  const players = document.getElementById('players');
  players.innerHTML = '';
  Object.values(game.players).forEach(p => {
    players.innerHTML += `<div class="player">${p.name}<br>${p.ready?'bereit':'wartet'}</div>`;
  });

  const letters = document.getElementById('letters');
  letters.innerHTML = '';
  (game.letters||[]).forEach(l=>{
    letters.innerHTML += `<div class="letter">${l}</div>`;
  });

  document.getElementById('submitted').textContent =
    game.submittedWord ? `Wort: ${game.submittedWord}` : '';

  document.getElementById('voting').style.display =
    game.phase === 'VOTING' && myId !== game.submitterId ? 'block' : 'none';

  const scores = document.getElementById('scores');
  scores.innerHTML = '';
  Object.values(game.players).forEach(p=>{
    scores.innerHTML += `<div class="player">${p.name}<br>${p.score} Punkte</div>`;
  });
});
</script>
</body>
</html>
